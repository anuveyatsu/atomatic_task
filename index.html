<html>
  <head>
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://trifacta.github.io/vega/vega.js"></script>
    <style>
      * { font-family: Helvetica Neue, Helvetica, Arial, sans-serif; }
      body { width: 450px; line-height: 16pt; }
    </style>
  </head>
  <body>
    <p><strong>Henry Hub Natural Gas Spot Price</strong></p>
    <div id="view" class="view"></div>
  </body>
  <script type="text/javascript">
    var data = { "points" : [] };
    var somedate;
    d3.csv("data_daily.csv", function(error, mydata){
        for (var i = 0; i < mydata.length; i++) {
          var x = new Date(mydata[i].date);
          var y = parseFloat(mydata[i].price);
          data.points.push({"x":x,"y":y});
        }
        vegaFunc();
    });

    var spec = {
      "width": 900,
      "height": 500,
      "padding": {"top": 40, "left": 50, "bottom": 50, "right": 40},
      "data": [{"name" : "points"}],
          "scales": [
                  {
                    "name": "x",
                    "type": "utc",
                    "nice": true,
                    "range": "width",
                    "domain": {"data": "points", "field": "data.x"},
                    "zero": false
                  },
                  {
                    "name": "y",
                    "nice": true,
                    "range": "height",
                    "domain": {"data": "points", "field": "data.y"}
                  }
          ],
          "axes": [
                  {"type": "x", "scale": "x", "title": "Year", "ticks": 20},
                  {"type": "y", "scale": "y", "title": "Dollars per Million Btu", "ticks": 20}
          ],
          "marks": [
                  {
                    "type": "line",
                    "from": {"data": "points"},
                    "properties": {
                      "enter": {
                        "x": {"scale": "x", "field": "data.x"},
                        "y": {"scale": "y", "field": "data.y"},
                        "stroke": {"value": "steelblue"},
                        "fillOpacity": {"value": 0.5}
                      },
                      "update": {
                        "fill": {"value": "transparent"},
                        "size": {"value": 100}
                      },
                      "hover": {
                        "fill": {"value": "pink"},
                        "size": {"value": 300}
                      }
                    }
                  }
          ]
    };

    var vegaFunc = function() {
      vg.parse.spec(spec, function(chart) {
        var view = chart({el:"#view", data:data})
          .update();
      });
    }

  </script>
</html>
